# 第一篇小论文--新版本

原论文工作在于 毫米波信道模型 + 低精度ADC接收量化 + 大规模MU-MISO 系统下的 SE近似计算公式推导。
现引入波束训练框架，设定存在波束估计上的相位误差，此外，波束估计一般只能测得一个能量最强的空间角度，但毫米波信道很可能存在其他散射路径，这种信息估计阶段和优化设计阶段的矛盾可以通过这种理论上的性能推导来进行分析。
实际上，除了相位误差之外，很可能还存在信道增益系数上的估计失误，如果上述工作进行顺利、时间尚有余量的话，才可以引入探讨。

## 相位误差模型

实际的阵列响应向量如下，其中存在估计失误、码本量化问题、硬件限制等原因导致的信息误差。
![通用阵列模型](./img/generalize_array_phase_error.png) 

【注意】上述改为$e^{-jkcos(\phi)}$，加了负号！

波束训练过程是根据码本设计波束扫描角度空间，因此**估计的**阵列响应向量记为下式：

\[{\bf{a}}\left( \phi  \right) = {\left( {{e^{ - j{f_1}\left( \phi  \right)}},{e^{ - j{f_2}\left( \phi  \right)}}, \cdots ,{e^{ - j{f_M}\left( \phi  \right)}}} \right)^T}\]
这也是**线性预编码器**使用的输入信息。

## 线性预编码器

基站需要使用combiner将多天线接收到的信号解析成原始数据向量，三种常用的线性precoder/combiner如下所示：

### MRC

- **计算式：**  ${\bf{W}} = {{\bf{H}}^H}$
- **核心目标：** 使得所有天线发射的信号在接收端能够同相叠加，从而实现最大的信号增益 (Maximize Received Signal Power)。
- **缺点：** 完全不考虑用户间干扰 (Inter-User Interference, IUI)。

### ZF

- **计算式：**  ${\bf{W}} = {{\bf{H}}^H}{({\bf{H}}{{\bf{H}}^H})^{ - 1}}$
- **核心目标：** 完全消除用户间干扰 (Completely Eliminate IUI)。
- **缺点：**
  噪声放大效应： 为了强制消除干扰，ZF可能会在某些方向上过度放大信号，从而也放大了噪声，导致在低信噪比区域性能很差。
  信道条件要求高： 当用户信道之间相关性很高时（例如用户物理位置很近），伪逆矩阵的计算会变得不稳定，性能急剧下降。
  它为了“清零”干扰，可能会牺牲掉一部分有用的信号能量。
  
### MMSE

- 可以看作是MRT和ZF的折中和升级版，**计算式：**  ${\bf{W}} = {{\bf{H}}^H}{({\bf{H}}{{\bf{H}}^H} + {\sigma ^2}{\bf{I}})^{ - 1}}$
- **核心目标**：在“信号增益”和“干扰抑制”之间取得平衡，最小化发送符号和接收符号之间的均方误差。
- **缺点**：计算复杂度最高，且需要同时知道信道信息（H）和噪声功率信息。

### 功率归一化

BS端天线数量为N时，上述线性编码器计算出来后需要归一化为：
\[{\bf{W}} = \frac{1}{{\sqrt N }}{\bf{W}}\]

## 信道模型

假设存在一条强度明显更高的LOS路径和多条强度较弱的散射路径共同组成了毫米波信道：

  \[
  \mathbf{h} = \sqrt{\beta_0} \tilde{\mathbf{a}}(\varphi_0) + \sum_{l=1}^L \sqrt{\beta_l} \tilde{\mathbf{a}}(\varphi_l),
  \]
<img src="img/mmwave channel model.png" alt="dd" width="60%"/>
参考[1]中的参数设置:
<img src="img/channel coefficients.png" alt="dd" width="75%"/>
不同的是，我们假设LOS角度已经通过波束训练寻找到最近的码字，所以LOS角度是确定值。

另有一种Rician信道模型，可参考 [2] (4) 式。

## 上行速率

### 计算公式

经过量化后，BS端接收到的K个单天线用户发送的 **总** 信号向量为：
\[{\bf{z}} = {{\bf{W}}^H}{{\bf{y}}_{\bf{q}}} = \sqrt {{p_u}} \alpha {{\bf{W}}^H}{\bf{Hx}} + \alpha {{\bf{W}}^H}{\bf{n}} + {{\bf{W}}^H}{{\bf{n}}_{\bf{q}}}\]
其中 $\alpha $ 是量化系数，是量化比特数 $b$ 的函数。

用户k对应的信号则为：
\[{z_k} = \sqrt {{p_u}} \alpha {\bf{w}}_k^H{{\bf{h}}_k}{x_k} + \sqrt {{p_u}} \alpha \sum\limits_{m = 1,m \ne k}^K {{\bf{w}}_k^H{{\bf{h}}_m}{x_m}}  + \alpha {\bf{w}}_k^H{\bf{n}} + {\bf{w}}_k^H{{\bf{n}}_q}\]

用户k的可达速率的计算式为：
\[{R_k} = {\log_2}\left( {1 + {\rm{SIN}}{{\rm{R}}_k}} \right)\]
其中：
\[{\rm{SIN}}{{\rm{R}}_k} = \frac{{{p_u}{\alpha ^2}{{\left| {{\bf{w}}_k^H{{\bf{h}}_k}} \right|}^2}}}{{{p_u}{\alpha ^2}\sum\limits_{m = 1,m \ne k}^K {{{\left| {{\bf{w}}_k^H{{\bf{h}}_m}} \right|}^2} + {\alpha ^2}{{\left| {{\bf{w}}_k^H{{\bf{n}}_q}} \right|}^2} + {{\left\| {{\bf{w}}_k^H} \right\|}^2}} }}\]

且量化噪声方差计算式为[3]中(9)式：
\[\begin{array}{l}
{{\bf{R}}_{{{\bf{n}}_{\bf{q}}}{{\bf{n}}_{\bf{q}}}}} = E\left\{ {{{\bf{n}}_{\bf{q}}}{\bf{n}}_{\bf{q}}^H\left| {\bf{h}} \right.} \right\}\\
 \approx \alpha \left( {1 - \alpha } \right)E\left\{ {{{\bf{y}}_{\bf{q}}}{\bf{y}}_{\bf{q}}^H} \right\}\\
 = \alpha \left( {1 - \alpha } \right)diag\left( {{p_u}{\bf{h}}{{\bf{R}}_{{\bf{xx}}}}{{\bf{h}}^H} + {{\bf{R}}_{{\bf{nn}}}}} \right)\\
 = \alpha \left( {1 - \alpha } \right)diag\left( {{p_u}{\bf{h}}{{\bf{h}}^H} + {\bf{I}}} \right)
\end{array}\]

<img src="img/quantize_covariance.png" alt="dd" width="75%"/>

### 闭式近似计算式推导

根据[2] Lemma 1：

<img src="img/Lemma 1.png" alt="dd" width="75%"/>

将用户和速率的近似计算式--期望函数 简化为：
\[{R_n} = E\left\{ {{{\log }_2}\left( {1 + \frac{{{B_1}}}{{{B_2} + {B_3} + {B_4}}}} \right)} \right\} \approx {\log _2}\left( {1 + \frac{{E\{ {B_1}\} }}{{{\rm{E}}\{ {B_2}\}  + {\rm{E}}\{ {B_3}\}  + {\rm{E}}\{ {B_4}\} }}} \right)\]

其中 $B_1、B_2、B_3、B_4$ 分别为 目标信号因子、用户干扰因子、量化误差因子、白噪声因子。

## 参考文献

[1] Near-Optimal Beam Selection for Beamspace MmWave Massive MIMO  
[2] SystemsPower Scaling of Uplink Massive MIMO Systems with Arbitrary-Rank Channel Means
[3] Performance Analysis of UCA-OAM Systems With Low-Resolution ADCs
